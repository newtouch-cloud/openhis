<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <script type="text/javascript" src="jquery/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="/ServicePage.aspx?js=1"></script>
    <title></title>
</head>
<body>
    <input type="button" value="本地文档加载" onclick="document.getElementById('myWriterControl').DCExecuteCommand('FileOpen', true, null);" />
    <input type="button" value="前端加载文档1" onclick="func_loadxmlstring1();" />
    <input type="button" value="前端加载文档2" onclick="func_loadxmlstring2();" />
    <input type="button" value="打印预览" onclick="document.getElementById('myWriterControl').LoadPrintPreview();" />
    <input type="button" value="关闭预览" onclick="document.getElementById('myWriterControl').ClosePrintPreview();" />
    <input type="button" value="直接打印" onclick="document.getElementById('myWriterControl').PrintDocument();" />
    <input type="button" value="关于对话框" onclick="document.getElementById('myWriterControl').AboutControl();" />
    <div id="myWriterControl"  style="width: 100%; border: 2px solid black; border-radius: 5px;height:900px;"
         contentrendermode="NormalHtmlEditable"
         workspacebackcolorstring="#B1CAEB"
         workspacebackgroundimage="Workspace-Background.png"
         servicepageurl="/ServicePage.aspx"
         heightcompress="true"
         imagedataembedinhtml="true"
         serversleepfordebug="0"
         allowcopy="true"
         usedcwriterminijs="false"
         useclassattribute="true"
         supportactivex="False"
         pixelpagespacing="5"
         clientcontextmenutype="Custom"
         showdebuginfo="false"
         HeaderFooterSelect="true"
         OutputFieldBorderChar="false"
         HeaderFooterEditable="true"
         ismobiledevice="false"
         FreeSelection="true"
         FieldBorderPrintVisibility="Visible"
         registercodeindex="0">
    </div>
    <script type="text/javascript">
        // HTML页面加载后执行本函数
        function BuildDCWriterControlFrame() {
            var ctl = document.getElementById("myWriterControl");
            BindingDCWriterClientControl(ctl);
            ctl.DocumentOptions.ViewOptions.ShowInputFieldStateTag = true;
            ctl.DocumentOptions.BehaviorOptions.AcceptDataFormats = "Text";//粘贴不带格式
            //ctl.Options.CustomCSSString = "*{outline:none;}";
            //ctl.Options.AutoZoom = true;
            //ctl.Options.CustomCSSString = "body{zoom:100;}"
            //ctl.Options.CustomCSSString = "word-break: break-word";
            //ctl.Options.FormView = "Normal";
            ctl.Options.ExcludeKeywords = "子宫,月经";
            ctl.DocumentOptions.ViewOptions.IgnoreFieldBorderWhenPrint = false;
            ctl.DocumentOptions.ViewOptions.ShowHeaderBottomLine = true;
            ctl.DocumentOptions.ViewOptions.BothBlackWhenPrint = true;
            // 创建编辑器框架
            ctl.BuildFrame(function () {

            });
        }
        BuildDCWriterControlFrame();
        function func_loadxmlstring1() {
            $.ajax({
                url: "/TestFile/入院记录.xml", // + name,
                dataType: 'text',
                type: 'GET',
                timeout: 2000,
                error: function (xml) {
                    alert("加载XML 文件出错！");
                },
                success: function (xml) {
                    var ctl = document.getElementById("myWriterControl");
                    var result = ctl.LoadDocumentFromString(xml, "xml");
                }
            });
        }
        function func_loadxmlstring2() {
            $.ajax({
                url: "/TestFile/护理记录单.xml", // + name,
                dataType: 'text',
                type: 'GET',
                timeout: 2000,
                error: function (xml) {
                    alert("加载XML 文件出错！");
                },
                success: function (xml) {
                    var ctl = document.getElementById("myWriterControl");
                    var result = ctl.LoadDocumentFromString(xml, "xml");
                }
            });
        }

    </script>
</body>
</html >
